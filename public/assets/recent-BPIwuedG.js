import{r as m,_ as w,a as M}from"./copy.vue_vue_type_script_setup_true_lang-D2JLc969.js";import{d as V}from"./dayjs.min-2rai63wT.js";import{b as H}from"./index.browser-DOhwxs98.js";import{s as R}from"./index-CAeUqk_d.js";import{s as F,b as x,c as Y}from"./downloader-ChGEyP82.js";import{d as j,C as D,e as i,E as K,k as N,c as v,h as a,i as l,f as A,g as o,w as r,F as E,t as _,a as L,j as y,o as p,_ as S}from"./index-sddtBqph.js";const T={class:"page"},U={class:"topbar"},q={key:0,class:"empty"},G={class:"title_area"},I={class:"title"},O={class:"flex"},J={class:"select-none text-gray-400 text-xs"},Q={key:0,class:"select-none text-gray-400 text-xs ml-8"},W=j({__name:"recent",setup(X){const h=D(),k=i(),d=i(""),f=i(!1);document.title="AnimeHelper | 最近更新";const c=i("kisssub"),b=[{name:"Kisssub",code:"kisssub"},{name:"Mikan",code:"mikan"}],z=K(()=>d.value==""?m().list:m().list.filter(s=>s.title.includes(d.value)));async function g(){f.value=!0,await m().getList(c.value),f.value=!1}const u=i(),B=s=>{u.value.visible=!0,u.value.url=s.url,u.value.magnet=s.magnet};function C(s){if(s===0)return"0 B";const t=["B","KB","MB","GB","TB","PB"],e=Math.floor(Math.log(s)/Math.log(1024)),n=s/Math.pow(1024,e);return`${parseFloat(n.toFixed(2)).toString()} ${t[e]}`}N(async()=>{g()});const $=(s,t)=>{h.require({target:s.currentTarget,message:"你确定要下载它吗",rejectProps:{label:"取消",severity:"secondary",outlined:!0,size:"small"},acceptProps:{size:"small",label:"下载"},accept:()=>m().download(t)})};return(s,t)=>(p(),v(E,null,[a("div",T,[a("div",U,[l(o(H),{size:"small",options:b,modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=e=>c.value=e),optionLabel:"name","option-value":"code",fluid:!1,onChange:g},null,8,["modelValue"]),l(o(R),{size:"small",modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=e=>d.value=e)},null,8,["modelValue"])]),f.value?(p(),v("div",q,t[2]||(t[2]=[a("div",{class:"add_tip"},[a("i",{class:"pi pi-spin pi-spinner",style:{"font-size":"20px"}}),a("div",{style:{"margin-left":"10px"}},"正在加载中...")],-1)]))):(p(),A(o(F),{key:1,value:z.value},{default:r(()=>[l(o(x),{field:"title",header:"标题"},{body:r(e=>[a("div",G,[a("div",I,_(e.data.title),1),a("div",O,[a("div",J,_(o(V)(e.data.time).format("YYYY-MM-DD HH:mm")),1),c.value!="kisssub"?(p(),v("div",Q,_(C(e.data.length)),1)):L("",!0)])])]),_:1}),l(o(x),{header:"操作",style:{"min-width":"150px"}},{body:r(e=>[l(o(Y),null,{default:r(()=>[l(o(y),{severity:"secondary",icon:"pi pi-link",size:"small",style:{"font-size":"12px"},onClick:n=>B(e.data)},null,8,["onClick"]),l(o(y),{severity:"secondary",label:"添加至",size:"small",style:{"font-size":"12px"},onClick:n=>k.value.showAddHandler(e.data.title)},null,8,["onClick"]),l(o(y),{severity:"secondary",size:"small",onClick:n=>$(n,e.data.url)},{default:r(()=>t[3]||(t[3]=[a("i",{class:"pi pi-download",style:{"font-size":"12px"}},null,-1)])),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["value"]))]),l(w,{ref_key:"addRef",ref:k},null,512),l(M,{ref_key:"copyRef",ref:u},null,512)],64))}}),oe=S(W,[["__scopeId","data-v-e77e0b69"]]);export{oe as default};
