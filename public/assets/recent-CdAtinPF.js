import{r as m,_ as w,a as M}from"./copy.vue_vue_type_script_setup_true_lang-CErl6ce5.js";import{_ as V}from"./loading.vue_vue_type_script_setup_true_lang-B2aq3bC0.js";import{d as H}from"./dayjs.min-2rai63wT.js";import{b as R}from"./index.browser-pToC0Rvn.js";import{s as F}from"./index-CAYSxIQR.js";import{s as Y,b as g,c as j}from"./downloader-YOs-v6U9.js";import{d as D,e as i,C as K,E as N,k as A,c as k,h as o,i as t,g as l,w as r,F as E,t as p,a as L,j as _,o as h,_ as S}from"./index-YslYnHGW.js";const T={class:"page"},U={class:"topbar"},q={class:"title_area"},G={class:"title"},I={class:"flex"},O={class:"select-none text-gray-400 text-xs"},J={key:0,class:"select-none text-gray-400 text-xs ml-8"},Q=D({__name:"recent",setup(W){const f=i(),x=K(),v=i(),d=i("");document.title="AnimeHelper | 最近更新";const c=i("kisssub"),$=[{name:"Kisssub",code:"kisssub"},{name:"Mikan",code:"mikan"}],b=N(()=>d.value==""?m().list:m().list.filter(a=>a.title.includes(d.value)));async function y(){f.value.loadingHandler(!0,"获取最近更新列表"),await m().getList(c.value),f.value.loadingHandler(!1,"获取最近更新列表")}const u=i(),C=a=>{u.value.visible=!0,u.value.url=a.url,u.value.magnet=a.magnet};function z(a){if(a===0)return"0 B";const s=["B","KB","MB","GB","TB","PB"],e=Math.floor(Math.log(a)/Math.log(1024)),n=a/Math.pow(1024,e);return`${parseFloat(n.toFixed(2)).toString()} ${s[e]}`}A(async()=>{y()});const B=(a,s)=>{x.require({target:a.currentTarget,message:"你确定要下载它吗",rejectProps:{label:"取消",severity:"secondary",outlined:!0,size:"small"},acceptProps:{size:"small",label:"下载"},accept:()=>m().download(s)})};return(a,s)=>(h(),k(E,null,[o("div",T,[o("div",U,[t(l(R),{size:"small",options:$,modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=e=>c.value=e),optionLabel:"name","option-value":"code",fluid:!1,onChange:y},null,8,["modelValue"]),t(l(F),{size:"small",modelValue:d.value,"onUpdate:modelValue":s[1]||(s[1]=e=>d.value=e)},null,8,["modelValue"])]),t(l(Y),{value:b.value},{default:r(()=>[t(l(g),{field:"title",header:"标题"},{body:r(e=>[o("div",q,[o("div",G,p(e.data.title),1),o("div",I,[o("div",O,p(l(H)(e.data.time).format("YYYY-MM-DD HH:mm")),1),c.value!="kisssub"?(h(),k("div",J,p(z(e.data.length)),1)):L("",!0)])])]),_:1}),t(l(g),{header:"操作",style:{"min-width":"150px"}},{body:r(e=>[t(l(j),null,{default:r(()=>[t(l(_),{severity:"secondary",icon:"pi pi-link",size:"small",style:{"font-size":"12px"},onClick:n=>C(e.data)},null,8,["onClick"]),t(l(_),{severity:"secondary",label:"添加至",size:"small",style:{"font-size":"12px"},onClick:n=>v.value.showAddHandler(e.data.title)},null,8,["onClick"]),t(l(_),{severity:"secondary",size:"small",onClick:n=>B(n,e.data.url)},{default:r(()=>s[2]||(s[2]=[o("i",{class:"pi pi-download",style:{"font-size":"12px"}},null,-1)])),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["value"])]),t(V,{ref_key:"loadingRef",ref:f},null,512),t(w,{ref_key:"addRef",ref:v},null,512),t(M,{ref_key:"copyRef",ref:u},null,512)],64))}}),oe=S(Q,[["__scopeId","data-v-007e5e1f"]]);export{oe as default};
