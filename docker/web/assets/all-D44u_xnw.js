import{x as A,u as $,e as c,p as b,q as x,v as w,d as z,f as I,w as m,g as o,h as d,t as C,i as t,j as y,o as H,A as q,y as B,c as L,F as R,_ as j}from"./index-462V7mWl.js";import{_ as M}from"./loading.vue_vue_type_script_setup_true_lang-BSSBdued.js";import{d as T}from"./downloader-BAO2iDWJ.js";import{s as U}from"./index.browser-C3Hd0ZRB.js";import{s as k}from"./index-BvykPrIl.js";import{s as F,b as h,c as N}from"./index-BnK1-1sO.js";const g=A("all",()=>{const p=$(),i=c([]);return{download:async a=>{const{data:s}=await b.post(`${x}/api/all/download`,{link:a},{headers:{token:w().token}});s.ok?p.add({severity:"success",summary:"下载成功",detail:"已添加到Aria下载队列",life:3e3}):p.add({severity:"error",summary:"下载失败",detail:s.msg,life:3e3})},list:i,getList:async()=>{const{data:a}=await b.get(`${x}/api/all/get`,{headers:{token:w().token}});if(a.ok){const s=a.msg;i.value=s}else p.add({severity:"error",summary:"请求失败",detail:a.msg,life:3e3})}}}),O={class:"mb-5 select-text"},S={class:"flex items-center gap-2 mb-4"},D={class:"flex items-center gap-2 mb-4"},E={class:"flex justify-end gap-2"},P=z({__name:"add",setup(p,{expose:i}){const v=$(),n=c(!1),a=c(""),s=c(""),r=c(""),u=async()=>{if(a.value.length==0){v.add({severity:"error",summary:"添加失败",detail:"标题不能为空",life:3e3});return}else if(s.value.length==0){v.add({severity:"error",summary:"添加失败",detail:"字幕组不能为空",life:3e3});return}await T().addToList(a.value,s.value),n.value=!1};return i({showAddHandler:f=>{n.value=!0,r.value=f;const e=f.match(/\[(.*?)\]/),l=f.match(/【(.*?)】/),V=e?f.indexOf(e[0]):1/0;(l?f.indexOf(l[0]):1/0)<V?s.value=l[1]:e?s.value=e[1]:l&&(s.value=l[1])}}),(f,e)=>(H(),I(o(U),{visible:n.value,"onUpdate:visible":e[3]||(e[3]=l=>n.value=l),modal:"",header:"添加到下载器列表...",style:{width:"25rem"},draggable:!1,class:"select-none",closable:!1},{default:m(()=>[d("div",O,C(r.value),1),d("div",S,[e[4]||(e[4]=d("label",{for:"title",class:"font-semibold w-20"},"标题",-1)),t(o(k),{size:"small",id:"title",class:"flex-auto",autocomplete:"off",modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=l=>a.value=l)},null,8,["modelValue"])]),d("div",D,[e[5]||(e[5]=d("label",{for:"ass",class:"font-semibold w-20"},"字幕组",-1)),t(o(k),{size:"small",id:"ass",class:"flex-auto",autocomplete:"off",modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=l=>s.value=l)},null,8,["modelValue"])]),d("div",E,[t(o(y),{type:"button",label:"取消",severity:"secondary",onClick:e[2]||(e[2]=l=>n.value=!1),size:"small"}),t(o(y),{type:"button",label:"添加",onClick:u,size:"small"})])]),_:1},8,["visible"]))}}),G={class:"page"},J={class:"title"},K=z({__name:"all",setup(p){const i=c(),v=q(),n=c();document.title="AnimeHelper | 所有",B(async()=>{i.value.loadingHandler(!0,"获取所有列表"),await g().getList(),i.value.loadingHandler(!1,"获取所有列表")});const a=(s,r)=>{v.require({target:s.currentTarget,message:"你确定要下载它吗",rejectProps:{label:"取消",severity:"secondary",outlined:!0,size:"small"},acceptProps:{size:"small",label:"下载"},accept:()=>g().download(r)})};return(s,r)=>(H(),L(R,null,[d("div",G,[t(o(F),{value:o(g)().list},{default:m(()=>[t(o(h),{field:"title",header:"标题"},{body:m(u=>[d("div",J,C(u.data.title),1)]),_:1}),t(o(h),{header:"操作",style:{"min-width":"150px"}},{body:m(u=>[t(o(N),null,{default:m(()=>[t(o(y),{severity:"secondary",label:"添加至",size:"small",style:{"font-size":"12px"},onClick:_=>n.value.showAddHandler(u.data.title)},null,8,["onClick"]),t(o(y),{severity:"secondary",size:"small",onClick:_=>a(_,u.data.url)},{default:m(()=>r[0]||(r[0]=[d("i",{class:"pi pi-download",style:{"font-size":"12px"}},null,-1)])),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["value"])]),t(M,{ref_key:"loadingRef",ref:i},null,512),t(P,{ref_key:"addRef",ref:n},null,512)],64))}}),ae=j(K,[["__scopeId","data-v-82a68c2c"]]);export{ae as default};
